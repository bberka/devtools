---
import Layout from '@/layouts/Layout.astro';
import { TOOLS } from '@/lib/utils/tools-config';
import { Button } from '@/components/preact/ui/button';
import { FavoriteButton } from '@/components/preact/FavoriteButton';
import { ArrowLeft } from 'lucide-preact';

// Import Phase 2 tools
import { Base64Converter } from '@/components/preact/tools/Base64Converter';
import { UrlEncoder } from '@/components/preact/tools/UrlEncoder';
import { HtmlEncoder } from '@/components/preact/tools/HtmlEncoder';
import { NumberBaseConverter } from '@/components/preact/tools/NumberBaseConverter';
import { UuidGenerator } from '@/components/preact/tools/UuidGenerator';
import { TimestampConverter } from '@/components/preact/tools/TimestampConverter';
import { LoremIpsumGenerator } from '@/components/preact/tools/LoremIpsumGenerator';
import { PasswordGenerator } from '@/components/preact/tools/PasswordGenerator';
import { HashGenerator } from '@/components/preact/tools/HashGenerator';

// Import Phase 3 tools
import { JsonFormatter } from '@/components/preact/tools/JsonFormatter';
import { XmlFormatter } from '@/components/preact/tools/XmlFormatter';
import { SqlFormatter } from '@/components/preact/tools/SqlFormatter';
import { JwtDecoder } from '@/components/preact/tools/JwtDecoder';
import { ColorConverter } from '@/components/preact/tools/ColorConverter';
import { CaseConverter } from '@/components/preact/tools/CaseConverter';

// Import Phase 4 tools
import { TextEscape } from '@/components/preact/tools/TextEscape';
import { XmlValidator } from '@/components/preact/tools/XmlValidator';
import { RegexTester } from '@/components/preact/tools/RegexTester';
import { CronParser } from '@/components/preact/tools/CronParser';

// Import Phase 5 tools (Advanced Converters & Text Tools)
import { JsonYamlXmlConverter } from '@/components/preact/tools/JsonYamlXmlConverter';
import { MarkdownPreviewer } from '@/components/preact/tools/MarkdownPreviewer';
import { TextDiff } from '@/components/preact/tools/TextDiff';
import { ImageConverter } from '@/components/preact/tools/ImageConverter';
import { MarkdownConverter } from '@/components/preact/tools/MarkdownConverter';

// Import Phase 6 tools (Security)
import { RsaKeyGenerator } from '@/components/preact/tools/RsaKeyGenerator';
import { AesEncryption } from '@/components/preact/tools/AesEncryption';
import { BcryptHasher } from '@/components/preact/tools/BcryptHasher';

export async function getStaticPaths() {
  return TOOLS.map((tool) => ({
    params: { slug: tool.id },
    props: { tool },
  }));
}

const { tool } = Astro.props;

if (!tool) {
  return Astro.redirect('/404');
}

// List of implemented tool IDs (Phase 2, 3, 4, 5 & 6)
const implementedTools = [
  'base64-converter',
  'url-encoder',
  'html-encoder',
  'number-base-converter',
  'uuid-generator',
  'timestamp-converter',
  'lorem-ipsum',
  'password-generator',
  'hash-generator',
  'json-formatter',
  'xml-formatter',
  'sql-formatter',
  'jwt-decoder',
  'color-converter',
  'case-converter',
  'text-escape',
  'xml-validator',
  'regex-tester',
  'cron-parser',
  'json-yaml-xml',
  'markdown-preview',
  'text-diff',
  'image-converter',
  'markdown-to-pdf',
  'rsa-key-generator',
  'aes-encryption',
  'bcrypt-hasher',
];
---

<Layout title={`${tool.name} - Dev Tools`} description={tool.description}>
  <div class="max-w-6xl mx-auto space-y-6">
    <!-- Header -->
    <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between pb-6">
      <div class="flex items-start gap-4">
        <a href="/" class="shrink-0">
          <Button variant="ghost" size="icon" client:load>
            <ArrowLeft className="h-5 w-5" />
          </Button>
        </a>
        <div class="min-w-0">
          <h1 class="text-2xl font-bold sm:text-3xl break-words">{tool.name}</h1>
          <p class="text-muted-foreground mt-1 text-sm sm:text-base">
            {tool.description}
          </p>
        </div>
      </div>
      <div class="flex justify-end shrink-0 sm:block">
        <FavoriteButton toolId={tool.id} variant="icon" client:load />
      </div>
    </div>

    <!-- Tool Implementation -->
    {tool.id === 'base64-converter' && <Base64Converter client:load />}
    {tool.id === 'url-encoder' && <UrlEncoder client:load />}
    {tool.id === 'html-encoder' && <HtmlEncoder client:load />}
    {tool.id === 'number-base-converter' && <NumberBaseConverter client:load />}
    {tool.id === 'uuid-generator' && <UuidGenerator client:load />}
    {tool.id === 'timestamp-converter' && <TimestampConverter client:load />}
    {tool.id === 'lorem-ipsum' && <LoremIpsumGenerator client:load />}
    {tool.id === 'password-generator' && <PasswordGenerator client:load />}
    {tool.id === 'hash-generator' && <HashGenerator client:load />}
    {tool.id === 'json-formatter' && <JsonFormatter client:load />}
    {tool.id === 'xml-formatter' && <XmlFormatter client:load />}
    {tool.id === 'sql-formatter' && <SqlFormatter client:load />}
    {tool.id === 'jwt-decoder' && <JwtDecoder client:load />}
    {tool.id === 'color-converter' && <ColorConverter client:load />}
    {tool.id === 'case-converter' && <CaseConverter client:load />}
    {tool.id === 'text-escape' && <TextEscape client:load />}
    {tool.id === 'xml-validator' && <XmlValidator client:load />}
    {tool.id === 'regex-tester' && <RegexTester client:load />}
    {tool.id === 'cron-parser' && <CronParser client:load />}
    {tool.id === 'json-yaml-xml' && <JsonYamlXmlConverter client:load />}
    {tool.id === 'markdown-preview' && <MarkdownPreviewer client:load />}
    {tool.id === 'text-diff' && <TextDiff client:load />}
    {tool.id === 'image-converter' && <ImageConverter client:load />}
    {tool.id === 'markdown-to-pdf' && <MarkdownConverter client:load />}
    {tool.id === 'rsa-key-generator' && <RsaKeyGenerator client:load />}
    {tool.id === 'aes-encryption' && <AesEncryption client:load />}
    {tool.id === 'bcrypt-hasher' && <BcryptHasher client:load />}

    <!-- Placeholder for unimplemented tools -->
    {
      !implementedTools.includes(tool.id) && (
        <div class="border border-dashed rounded-lg p-12 text-center text-muted-foreground">
          <p class="text-lg">Tool implementation coming soon...</p>
          <p class="text-sm mt-2">This will be implemented in Phase 4-5</p>
        </div>
      )
    }
  </div>
</Layout>
